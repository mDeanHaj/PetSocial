<%- include("partials/header.ejs") %>

<div class="content-wrap">
    <!-- Blog Header -->
    <h1 class="page-title">Community Blog</h1>

    <!-- Blog Posts Section -->
    <div class="blog-posts">
        <% if (posts.length > 0) { %>
            <% posts.forEach(post => { %>
                <div class="post">
                    <h2 class="post-title"><%= post.title %></h2>
                    <p class="post-author">By <strong><%= post.username %></strong> on <%= new Date(post.created_at).toLocaleDateString() %></p>
                    <p class="post-content"><%= post.content %></p>
                </div>
                <hr class="post-divider">
            <% }) %>
        <% } else { %>
            <p class="no-posts-message">No posts yet. Be the first to share!</p>
        <% } %>
    </div>

    <!-- New Post Form (only for logged-in users) -->
    <% if (userId) { %>
        <div class="new-post-form">
            <h2>Share a New Post</h2>
            <form action="/blog" method="POST">
                <div class="form-group">
                    <label for="title">Title:</label>
                    <input type="text" id="title" name="title" required>
                </div>
                
                <div class="form-group">
                    <label for="content">Content:</label>
                    <textarea id="content" name="content" rows="5" required></textarea>
                </div>
                
                <button type="submit" class="form-button">Post</button>
            </form>
        </div>
    <% } else { %>
        <p class="login-prompt">Please <a href="/login">log in</a> to add a new post.</p>
    <% } %>
</div>

<br/><br/>

<%- include("partials/footer.ejs") %>

</body>
</html>
